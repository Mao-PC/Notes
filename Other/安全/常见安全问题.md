[toc]

# 常见安全问题



- 跨站脚本攻击 (CSS or XSS, Cross Site Scripting)
- SQL 注入攻击
- 远程命令执行 
- 目录遍历
- 文件包含
- 脚本代码暴露
- 跨帧脚本攻击
- Cookie 篡改
- URL 重定向



## 跨站脚本攻击



2006年全球网络安全弱点 TOP 10 荣登榜首, 特点为

1. 攻击难道小, 不论是技术还是实现攻击的成本上都比较容易
2. 存在的载体 (浏览器) 使用极其广泛
3. 锁依赖的技术被广泛应用与支持 ( JS, VB Script, HTML, ActiveX, Flash )



XSS 攻击，一般是指攻击者通过在网页中注入恶意脚本，当用户浏览网页时，恶意脚本执行，控制用户浏览器行为的一种攻击方式。

如一个没有经过安全设计并实现的论坛, 当你在跟帖时输入这样的代码 

```html
<script>alert(document.cookie);</script>
```



不管是哪一种技术实现的 XSS 攻击, 都离不开两点:

1. 浏览器的解析
2. 脚本语法
3. 脚本需要移动的长度



**解决方案:**

- 脚本注入的语法要素, 如 js 离不开 `< > ( ) ;` 等等, 所以只需要在数据或输出时对这些字符串进行专业就可以了. 转义字符会使用到 HTML 的原始码, 原始码是可以直接被浏览器识别的

- 允许数据的字符串长度限制也可以一定程度上控制脚本注入. 如页面表单姓名, 可以只允许输入 5 个字符串
- 这里的的 过滤/校验/转义 等策略, **一定要在Server端完成**, 不要使用在客户端的 JS 或者 VB 去做检查. 真正的攻击者耕读欧式借助于第三方工具, 可以绕过客户端校验



## SQL 注入攻击



如下SQL 

```sql
SELECT COUNT(*) FROM users WHERE username = 'admin' AND password = '123456';
```



如果在客户端输入用户名和密码时输入

用户名 : `a' or '1=1'`

密码: `a' or '1=1'`

这是 SQL 就会变成

```sql
SELECT COUNT(*) FROM users WHERE username = 'a' or '1=1' AND password = 'a' or '1=1';
```



这样就会获取到所有的用户

**解决方案:** 

- 和 XSS 相同, 它们都属于输入/输出验证

- 使用数据库预编译功能 

  针对 Mybatis 要注意 #{} 会预编译 但是 ${} 就是简单的字符串拼接, 在使用 ${} 时更容易导致 SQL 注入



## 远程命令执行 



远程命令执行漏洞，用户通过浏览器提交执行命令，由于服务器端没有针对执行函数做过滤，导致在没有指定绝对路径的情况下就执行命令



如: `abc@163.com < /etc/passwd` 执行的结果是什么? 结果是将 linux 系统的 passwd 文件 (linux 的系统用户信息) 发送到指定的邮箱 `abc@163.com`



**解决方案 :**

1. 严格限制运行 web 服务的用户权限. 就是web应用可以访问服务器的用户的权限. 一般情况下, 我们应该以白名单的形式界定web应用可以访问服务器系统的权限
2. 严格执行用户输入的合法校验. 注意这里输入 不一定是通过表单的键盘输入, 往往是web应用已经内地了某一些操作以供选择



## 目录遍历



假设某网站提供了网络硬盘服务吗当用户登录并开通了网络硬盘服务后, 可以进入自己的网络硬盘

```http
http://xxx.xxx.com/Personal_Spaces_List.jsp?dir=MyFolder
```

如果输入如下的 URL

```http
http://xxx.xxx.com/Personal_Spaces_List.jsp?dir=../../../../../../../usr/local/tomcat/conf
```

结果就是 `/usr/local/tomcat/conf` 所用的文件就被列举出来了



**解决方案 :**

1. 限制 web 应用在服务器上的运行
2. 进行严格的输入校验, 控制用户输入非法路径